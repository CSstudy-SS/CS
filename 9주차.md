## 스터디 주제

* TLS/SSL handshake
* 로드밸런싱
* 키(Key)정리

## 질문목록

### TLS/SSL handshake

- TLS handshake 과정을 설명해주세요

  <details>

    1. 클라이언트는 서버에게 `client hello` 메시지를 담아 서버로 보낸다. 이때 암호화된 정보를 함께 담는데, `버전`, `암호 알고리즘`, `압축 방식` 등을 담는다.

    2. 서버는 클라이언트가 보낸 암호 알고리즘과 압축 방식을 받고, `세션 ID`와 `CA 공개 인증서`를 `server hello` 메시지와 함께 담아 응답한다. 이 CA 인증서에는 앞으로 통신 이후 사용할 대칭키가 생성되기 전, 클라이언트에서 handshake 과정 속 암호화에 사용할 공개키를 담고 있다.

    3. 클라이언트 측은 서버에서 보낸 CA 인증서에 대해 유효한 지 CA 목록에서 확인하는 과정을 진행한다.

    4. CA 인증서에 대한 신뢰성이 확보되었다면, 클라이언트는 난수 바이트를 생성하여 서버의 공개키로 암호화한다. 이 난수 바이트는 대칭키를 정하는데 사용이 되고, 앞으로 서로 메시지를 통신할 때 암호화하는데 사용된다.

    5. 만약 2번 단계에서 서버가 클라이언트 인증서를 함께 요구했다면, 클라이언트의 인증서와 클라이언트의 개인키로 암호화된 임의의 바이트 문자열을 함께 보내준다.

    6. 서버는 클라이언트의 인증서를 확인 후, 난수 바이트를 자신의 개인키로 복호화 후 대칭 마스터 키 생성에 활용한다.

    7. 클라이언트는 handshake 과정이 완료되었다는 `finished` 메시지를 서버에 보내면서, 지금까지 보낸 교환 내역들을 해싱 후 그 값을 대칭키로 암호화하여 같이 담아 보내준다.

    8. 서버도 동일하게 교환 내용들을 해싱한 뒤 클라이언트에서 보내준 값과 일치하는 지 확인한다. 일치하면 서버도 마찬가지로 `finished` 메시지를 이번에 만든 대칭키로 암호화하여 보낸다.

    9. 클라이언트는 해당 메시지를 대칭키로 복호화하여 서로 통신이 가능한 신뢰받은 사용자란 걸 인지하고, 앞으로 클라이언트와 서버는 해당 대칭키로 데이터를 주고받을 수 있게 된다.
    
  </details>

- TLS란?
  <details>
    Transport Layer Security의 약자로서

  인터넷에서의 정보를 암호화해서 송수신하는 프로토콜, 넷스케이프 커뮤니케이션스사가 개발한 국제 인터넷 표준화 기구에서 표준으로 인정받은 프로토콜이다. TCP443 포트를 사용한다.
  </details>
- TLS 와 SSL의 차이점은?
  <details>
  보안: TLS는 더 강력한 암호화 알고리즘, 더 나은 인증 메커니즘 및 향상된 키 교환 프로토콜을 가지고 있습니다.

  프로토콜 버전: SSL은 2015년 이후 더 이상 안전하지 않으며 TLS는 계속 개발 및 개선되고 있습니다. TLS는 TLS 1.0, TLS 1.1, TLS 1.2, TLS 1.3을 포함한 여러 버전이 있으며, 각 버전은 이전 버전보다 더 나은 보안을 제공한다.

  등 성능, 호환성 모든 부분에서 ssl보다 좋다.
  </details>
- TLS는 전송중에 데이터의 기밀성과 무결성을 어떻게 제공하는가?
  <details>
  암호화 및 디지털 서명을 통해 전송 중 데이터의 기밀성과 무결성을 제공하는데,

  클라이언트와 서버간에 TLS 연결이 설정되면 클라이언트와 서버는 비대칭 암호화 알고리즘을 사용하여 공유 개인 키를 협상하고, 이를 대칭 암호화에 사용한다.

  그리고 전송중에 데이터가 조작되지 않도록 발신인은 개인 키를 사용하여 데이터를 서명하고, 수신인은 발신인의 공용 키를 사용하여 서명을 확인 한다.
  </details>
- TLS/SSL HandShake의 과정을 설명해주세요.
  <details>
  1. 클라이언트는 서버에게 `client hello`메시지를 담아 서버로 보낸다. 이때 암호화된 정보를 함께 담는데, `버전`, `암호 알고리즘`, `압축 방식` 등을 담는다.
  
  2. 서버는 클라이언트가 보낸 암호 알고리즘과 압축 방식을 받고, `세션 ID`와 `CA 공개 인`를 `server hello`메시지와 함께 담아 응답한다. 이 CA 인증서에는 앞으로 통신 이후 사용할 대칭키가 생성되기 전, 클라이언트에서 handshake 과정 속 암호화에 사용할 공개키를 담고 있다.
  
  3. 클라이언트 측은 서버에서 보낸 CA 인증서에 대해 유효한 지 CA 목록에서 확인하는 과정을 진행한다.
  
  4. CA 인증서에 대한 신뢰성이 확보되었다면, 클라이언트는 난수 바이트를 생성하여 서버의 공개키로 암호화한다. 이 난수 바이트는 대칭키를 정하는데 사용이 되고, 앞으로 서로 메시지를 통신할 때 암호화하는데 사용된다.
  
  5. 만약 2번 단계에서 서버가 클라이언트 인증서를 함께 요구했다면, 클라이언트의 인증서와 클라이언트의 개인키로 암호화된 임의의 바이트 문자열을 함께 보내준다.
  
  6. 서버는 클라이언트의 인증서를 확인 후, 난수 바이트를 자신의 개인키로 복호화 후 대칭 마스터 키 생성에 활용한다.
  
  7. 클라이언트는 handshake 과정이 완료되었다는 `finished` 메시지를 서버에 보내면서, 지금까지 보낸 교환 내역들을 해싱 후 그 값을 대칭키로 암호화하여 같이 담아 보내준다.
  
  8. 서버도 동일하게 교환 내용들을 해싱한 뒤 클라이언트에서 보내준 값과 일치하는 지 확인한다. 일치하면 서버도 마찬가지로 `finished` 메시지를 이번에 만든 대칭키로 암호화하여 보낸다.
  
  9. 클라이언트는 해당 메시지를 대칭키로 복호화하여 서로 통신이 가능한 신뢰받은 사용자란 걸 인지하고, 앞으로 클라이언트와 서버는 해당 대칭키로 데이터를 주고받을 수 있게 된다.
  </details>
- TLS 세션 재개란? FROM(chatGPT)
  <details>
  TLS 세션 재개는 클라이언트와 서버가 전체 핸드셰이크 프로세스를 다시 거치지 않고 이전에 설정한 TLS 세션을 재개할 수 있도록 해주는 기능이다. 

  이렇게 하면 새 TLS 연결을 설정하는 데 필요한 시간과 리소스가 줄어들어 성능이 향상됩니다. 또한 TLS 세션 재개는 공유 비밀 키가 교환되는 횟수를 줄여 보안을 향상시켜 키 교환 프로세스를 대상으로 하는 공격의 위험을 줄입니다.
  </details>
  
### 로드 밸런싱

- 대규모 트래픽에 대처할 수 있는 방법?

  <details>

    서버의 성능을 높이는 Scale-up과 분산 처리를 위해 여러 대의 서버를 두는 Scale-out이 있다. Scale-up 방식의 경우 한계가 있으므로 주로 Scale-out 방식을 사용한다. Scale-out 방식에서 분산 처리를 하기 위해 로드 밸런싱 기술을 사용한다.
    
  </details>

- Scale out 의 장점이 무엇인지 설명해주세요

  <details>

    - 하드웨어 향상하는 비용보다 서버 한대 추가 비용이 더 적습니다.

    - 여러 대의 Server 덕분에 무중단 서비스를 제공할 수 있습니다.
    
  </details>


- 로드 밸런서의 기본 기능은?

  <details>

    - 서버의 이상 유무를 파악하는 상태 확인(Health Check)

    - 패킷을 캡슐화해서 연결된 상호 간에만 패킷을 구별할 수 있게 해주는 터널링(Tunneling)

    - IP 주소를 변환해주는 NAT 기능이 있다.
    
  </details>


- 로드 밸런서의 종류?

  <details>

    로드 밸런서는 OSI 7계층을 기준으로 어떻게 부하를 분산하는 지에 따라 종류가 나뉜다. 그 중 L4 로드 밸런서와 L7 로드 밸런서가 가장 많이 활용된다.
    
  </details>


- L4 로드 밸런서와 L7 로드 밸런서의 차이점은?

  <details>

    - L4

        - 전송계층

        - TCP/UDP 포트 정보를 바탕으로한다.

        - 데이터 안을 들여다보지 않고, 패킷 레벨에서만 로드를 분산하기 때문에 속도가 빠르고 효율이 높다.

        - L7로드밸런서보다 가격이 저렴하다.

        - 패킷의 내용을 살펴볼 수 없기 때문에 섬세한 라우팅이 불가능하다.

        - 사용자의 IP가 수시로 바뀌는 경우라면 연속적인 서비스를 제공하기 어려움

    - L7

        - 응용 계층

        - TCP/UDP 정보는 물론 HTTP의 URI, FTP의 파일명, 쿠키 정보 등을 바탕으로 함

        - 상위 계층에서 로드를 분산하기 때문에 훨씬 더 섬세한 라우팅이 가능함

        - 캐싱 기능을 제공함

        - 비정상적인 트래픽을 사전에 필터링할 수 있어, 서비스 안정성이 높음

        - 패킷의 내용을 복호화해야하기에 더 높은 비용을 지불해야함

        - 클라이언트가 로드밸런서와 인증서를 공유해야하기 때문에 공격자가 로드밸ㄹ선서를 통해 클라이언트에 데이터에 접근할 보안 상의 위험성 존재
    
  </details>


- 로드밸런서 알고리즘에 대해 설명해주세요

  <details>

    L4 로드 밸런서에는 라운드 로빈, 가중치 할당 방식, 최소 연결, 응답 시간, 해시 가반, 대역폭 기반으로 특정 서버에 요청을 분배할 수 있다. L7 로드 밸런서의 경우 L4 로드 밸런서에 사용되는 방식 뿐만 아니라 URL 스위칭 방식, 컨텍스트 스위치 방식, 쿠키 지속성 방식이 있다.
    
  </details>


- 로드밸런서가 장애를 대비하는 방법에 대해 설명해주세요

  <details>

    로드 밸런서는 갑작스러운 장애에 대비해 이중화를 기본으로 구성한다. 이중화된 로드 밸런서들은 서로의 상태를 확인하며 장애가 발생하면 정상적으로 작동하는 로드 밸런서로 교체된다.
    
  </details>


- 로드밸런서 장치를 사용하지 않고, DNS를 활용해서 유사하게 로드밸런싱을 하는 방법에 대해 설명해주세요. → DNS 로드밸런싱

  <details>

    DNS 기반 로드밸런싱은 **동일한 도메인 이름을 가진 여러 서버 중에서 클라이언트에게 가장 적합한 서버를 선택하는 방식**입니다. 이 방식은 로드밸런서 장치를 사용하지 않아도 적용할 수 있습니다.

    DNS 기반 로드밸런싱은 **DNS 서버에 여러 IP 주소를 등록**하여, 각**각의 IP 주소가 다른 서버를 가리키도록 설정**합니다. 그리고 클라이언트가 해당 도메인 이름을 조회하면, **DNS 서버가 가리키는 IP 주소 중에서 랜덤하게 하나를 반환**합니다. 이렇게 반환된 IP 주소를 이용하여 클라이언트는 서버에 접속합니다.

    이 방식의 가장 큰 장점은 구성이 매우 간단하다는 것입니다. 하지만 **이 방식은 클라이언트와 서버 간의 연결을 관리하지 않기 때문에, 모든 서버가 동일한 성능을 가지고 있지 않을 경우에는 불균형한 로드밸런싱이 발생**할 수 있습니다. 또한 D**NS 서버가 일시적으로 다운되거나 DNS 캐시 문제로 인해 오래된 IP 주소를 반환하는 경우**도 발생할 수 있습니다.

    이러한 한계를 극복하기 위해, **TTL 값을 작게 설정하여 DNS 서버의 캐시를 자주 갱신**하거나, DNS 서버를 여러 개 사용하여 장애 발생 시에 대처할 수 있는 환경을 구성하는 등의 방법을 사용할 수 있습니다.
    
  </details>

### Key 정리

- 데이터 베이스를 구성하는 5가지 키에 대해 아는대로 말해주세요

    <details>

    - Candidate Key (후보키)

        - Tuple을 유일하게 식별하기 위해 사용하는 속성들의 부분 집합. (기본키로 사용할 수 있는 속성들)

    - Primary Key (기본키)

        - 후보키 중 선택한 Main Key

        - Null 값을 가질 수 없음

        - 동일한 값이 중복될 수 없음

    - Alternate Key (대체키)

        - 후보키 중 기본키를 제외한 나머지 키 = 보조키

    - Super Key (슈퍼키)

        - 유일성은 만족하지만, 최소성은 만족하지 못하는 키

    - Foreign Key (외래키)

        - 다른 릴레이션의 기본키를 그대로 참조하는 속성의 집합
        
  </details>
  
- LEFT OUTER JOIN 과 RIGHT OUTER JOIN 의 차이점은?
    <details>
      왼쪽테이블과 오른쪽테이블의 기준점의 차이점.
    </details>
- LEFT OUTER JOIN과 **INNER JOIN의 차이점은?**
    <details>
      두 테이블의 교집합만 조회할 것인가 왼쪽 테이블에 교집합을 추가한 부분을 조회할 것인가의 차이
    </details>
## 정리 링크

세정 : [9주차 학습 내용 정리](https://evening-november-9ec.notion.site/9-06b9b5aa468d41908f8e1114b11333b5)
<br>
준엽 : [9주차 학습 내용 정리](https://spot-visitor-fff.notion.site/Week9-TLS-SSL-JOIN-6ff89d3465ec42dc8b62879475ab411f)
